# AgentWire Distributed Configuration Example
# For setups with components on different machines
#
# This example shows a multi-machine setup:
#   - Portal runs on your laptop/desktop (main machine)
#   - TTS runs on a GPU server (for Chatterbox voice synthesis)
#   - STT runs locally (uses laptop's Neural Engine on macOS)
#   - Sessions can run locally or on remote machines
#
# Required: machines.json must have "gpu-server" defined

# === Server (runs on portal machine) ===
server:
  host: "0.0.0.0"
  port: 8765
  ssl:
    cert: "~/.agentwire/cert.pem"
    key: "~/.agentwire/key.pem"

  # Public URL that clients use to connect (for phones/tablets on LAN)
  public_url: "https://mac-mini.local:8765"

# === Projects ===
projects:
  dir: "~/projects"
  worktrees:
    enabled: true
    suffix: "-worktrees"

# === Service Locations (Network Topology) ===
# This is the key section for distributed setups.
# AgentWire uses this to determine which tunnels to create.
services:
  # Portal runs locally (where you run `agentwire portal start`)
  portal:
    machine: null               # null = this machine
    port: 8765
    health_endpoint: "/health"

  # TTS runs on GPU server (requires tunnel)
  # When you run `agentwire tunnels up`, it creates:
  #   ssh -L 8100:localhost:8100 -N -f developer@192.168.1.50
  tts:
    machine: "gpu-server"       # Must exist in machines.json
    port: 8100
    health_endpoint: "/health"

# === TTS Backend Settings ===
tts:
  backend: "chatterbox"

  # This URL is used AFTER the tunnel is created
  # Tunnel maps localhost:8100 -> gpu-server:8100
  url: "http://localhost:8100"

  default_voice: "default"
  exaggeration: 0.5
  cfg_weight: 0.5

# === STT (local on portal machine - uses Apple Neural Engine on macOS) ===
stt:
  backend: "whisperkit"
  model_path: "~/models/whisperkit/large-v3"
  language: "en"

# === Agent ===
agent:
  command: "claude --dangerously-skip-permissions"

# === Remote Machines Registry ===
machines:
  file: "~/.agentwire/machines.json"

rooms:
  file: "~/.agentwire/rooms.json"

# === Usage ===
# 1. Ensure machines.json has gpu-server defined
# 2. Run: agentwire tunnels up    (creates SSH tunnels)
# 3. Run: agentwire portal start  (starts web UI)
# 4. On GPU server: agentwire tts start
# 5. Access portal at https://localhost:8765
#
# Diagnostics:
#   agentwire network status    # Check all services
#   agentwire tunnels status    # Check tunnels
#   agentwire doctor            # Auto-fix issues
